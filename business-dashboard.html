<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Dashboard - PAT BuddAI 4U</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Quick Stats Footer Styles */
        .quick-stats-footer {
            margin-top: 20px;
        }
        .dashboard-section-center {
            text-align: center;
        }
        .quick-stats-title {
            color: #546E7A;
            margin-bottom: 10px;
        }
        .quick-stats-main {
            font-size: 1.2rem;
            color: #1565C0;
            font-weight: 600;
        }
        .quick-stats-main-alert {
            color: #F44336;
        }
        .quick-stats-sub {
            font-size: 0.9rem;
            color: #78909C;
            margin-top: 5px;
        }

        .contractor-desc {
            color: #546E7A;
            margin-bottom: 15px;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f0f7ff 0%, #e6f0ff 100%);
            min-height: 100vh;
            color: #333;
        }

        .navbar {
            background: linear-gradient(135deg, #1565C0 0%, #1976D2 100%);
            color: white;
            padding: 15px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(21, 101, 192, 0.2);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .nav-links {
            display: flex;
            gap: 25px;
        }

        .nav-link {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            font-weight: 500;
            padding: 8px 15px;
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .nav-link:hover, .nav-link.active {
            background: rgba(255, 255, 255, 0.15);
            color: white;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .company-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .logout-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 20px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .container {
            max-width: 1400px;
            margin: 30px auto;
            padding: 0 20px;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .welcome-section h1 {
            color: #0D47A1;
            font-size: 2.2rem;
            margin-bottom: 10px;
        }

        .welcome-section p {
            color: #546E7A;
            font-size: 1.1rem;
        }

        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .action-btn {
            background: linear-gradient(135deg, #1976D2 0%, #2196F3 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .action-btn.secondary {
            background: white;
            color: #1976D2;
            border: 2px solid #1976D2;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(33, 150, 243, 0.3);
        }

        .demo-badge {
            background: linear-gradient(135deg, #42A5F5 0%, #64B5F6 100%);
            color: white;
            padding: 6px 18px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        /* Stats Overview */
        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 25px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease;
            border-top: 5px solid;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card.compliance {
            border-top-color: #4CAF50;
        }

        .stat-card.equipment {
            border-top-color: #2196F3;
        }

        .stat-card.contractors {
            border-top-color: #FF9800;
        }

        .stat-card.alerts {
            border-top-color: #F44336;
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .stat-header h3 {
            font-size: 1rem;
            color: #546E7A;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .stat-icon.compliance {
            background: #E8F5E9;
            color: #4CAF50;
        }

        .stat-icon.equipment {
            background: #E3F2FD;
            color: #2196F3;
        }

        .stat-icon.contractors {
            background: #FFF3E0;
            color: #FF9800;
        }

        .stat-icon.alerts {
            background: #FFEBEE;
            color: #F44336;
        }

        .stat-value {
            font-size: 3rem;
            font-weight: 700;
            color: #0D47A1;
            margin: 10px 0;
        }

        .stat-change {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
            color: #546E7A;
        }

        .change-positive {
            color: #4CAF50;
        }

        .change-negative {
            color: #F44336;
        }

        /* Dashboard Sections */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .dashboard-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 25px rgba(0, 0, 0, 0.08);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #E3F2FD;
        }

        .section-header h2 {
            color: #1565C0;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .view-all {
            color: #1976D2;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .view-all:hover {
            color: #0D47A1;
            text-decoration: underline;
        }

        /* Sites Table */
        .sites-table {
            width: 100%;
            border-collapse: collapse;
        }

        .sites-table th {
            background: #E3F2FD;
            color: #1565C0;
            font-weight: 600;
            text-align: left;
            padding: 15px;
            border-bottom: 2px solid #BBDEFB;
        }

        .sites-table td {
            padding: 15px;
            border-bottom: 1px solid #E3F2FD;
        }

        .sites-table tr:hover {
            background: #F5FAFF;
        }

        .compliance-badge {
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .compliance-excellent {
            background: #E8F5E9;
            color: #2E7D32;
        }

        .compliance-good {
            background: #E3F2FD;
            color: #1565C0;
        }

        .compliance-warning {
            background: #FFF3E0;
            color: #EF6C00;
        }

        .compliance-poor {
            background: #FFEBEE;
            color: #C62828;
        }

        .site-actions {
            display: flex;
            gap: 8px;
        }

        .site-btn {
            background: none;
            border: 1px solid #BBDEFB;
            color: #1976D2;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .site-btn:hover {
            background: #1976D2;
            color: white;
            border-color: #1976D2;
        }

        /* Alerts Panel */
        .alerts-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .alert-item {
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid;
            background: #FFF;
            border: 1px solid #E3F2FD;
        }

        .alert-item.critical {
            border-left-color: #F44336;
            background: #FFF5F5;
        }

        .alert-item.warning {
            border-left-color: #FF9800;
            background: #FFFBF0;
        }

        .alert-item.info {
            border-left-color: #2196F3;
            background: #F5FAFF;
        }

        .alert-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
        }

        .alert-title {
            font-weight: 600;
            color: #0D47A1;
            font-size: 1rem;
        }

        .alert-time {
            font-size: 0.85rem;
            color: #78909C;
        }

        .alert-desc {
            color: #546E7A;
            font-size: 0.95rem;
            margin-bottom: 15px;
        }

        .alert-actions {
            display: flex;
            gap: 10px;
        }

        .alert-btn {
            background: none;
            border: 1px solid #90CAF9;
            color: #1976D2;
            padding: 6px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .alert-btn:hover {
            background: #1976D2;
            color: white;
        }

        /* Contractor Performance */
        .contractors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .contractor-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease;
        }

        .contractor-card:hover {
            transform: translateY(-3px);
        }

        .contractor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .contractor-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: #0D47A1;
        }

        .contractor-rating {
            background: #FFF3E0;
            color: #FF9800;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .contractor-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .contractor-stat {
            text-align: center;
        }

        .stat-label {
            font-size: 0.85rem;
            color: #78909C;
            margin-bottom: 5px;
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1565C0;
        }

        .contractor-actions {
            display: flex;
            gap: 10px;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            -webkit-backdrop-filter: blur(5);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            padding: 20px;
            animation: modalFadeIn 0.3s ease;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease;
            max-height: 90vh;
            overflow-y: auto;
            max-width: 600px;
            width: 100%;
        }

        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            color: #1565C0;
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: #999;
            padding: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .modal-close:hover {
            color: #333;
            transform: rotate(90deg);
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #333;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            z-index: 10001;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            max-width: 400px;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            background: linear-gradient(135deg, #4CAF50, #66BB6A);
        }

        .toast.info {
            background: linear-gradient(135deg, #2196F3, #42A5F5);
        }

        .toast.warning {
            background: linear-gradient(135deg, #FF9800, #FFB74D);
        }

        .toast.error {
            background: linear-gradient(135deg, #F44336, #EF5350);
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-links {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .navbar {
                padding: 15px 20px;
                flex-direction: column;
                gap: 15px;
            }
            
            .header-actions {
                flex-direction: column;
                width: 100%;
            }
            
            .action-btn {
                width: 100%;
                justify-content: center;
            }
            
            .stats-overview {
                grid-template-columns: 1fr;
            }
            
            .sites-table {
                display: block;
                overflow-x: auto;
            }
        }

        /* Empty States */
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #78909C;
        }

        .empty-state i {
            font-size: 3rem;
            color: #CFD8DC;
            margin-bottom: 15px;
            display: block;
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="logo">
            <span>üè¢</span>
            <span>PAT BuddAI 4U - Business Portal</span>
        </div>
        <div class="nav-links">
            <a href="#" class="nav-link active">Dashboard</a>
            <a href="#" class="nav-link">Sites</a>
            <a href="#" class="nav-link">Equipment</a>
            <a href="#" class="nav-link">Certificates</a>
            <a href="#" class="nav-link">Reports</a>
            <a href="#" class="nav-link">Contractors</a>
        </div>
        <div class="user-info">
            <div class="company-badge">TechCorp Global Ltd</div>
            <button class="logout-btn" onclick="logout()">Logout</button>
        </div>
    </nav>

    <!-- Main Dashboard -->
    <div class="container">
        <!-- Header -->
        <div class="dashboard-header">
            <div class="welcome-section">
                <h1>Compliance Dashboard</h1>
                <p>Monitor PAT testing across 8 sites, 1,245 assets, and 3 approved contractors</p>
            </div>
            <div class="header-actions">
                <button class="action-btn" onclick="generateReport()">
                    <span>üìä</span>
                    Generate Monthly Report
                </button>
                <button class="action-btn secondary" onclick="addNewSite()">
                    <span>üè¢</span>
                    Add New Site
                </button>
                <div class="demo-badge">DEMO ACCOUNT</div>
            </div>
        </div>

        <!-- Stats Overview -->
        <div class="stats-overview">
            <div class="stat-card compliance">
                <div class="stat-header">
                    <h3>Overall Compliance</h3>
                    <div class="stat-icon compliance">‚úì</div>
                </div>
                <div class="stat-value">94.7%</div>
                <div class="stat-change">
                    <span class="change-positive">‚Üë 2.3%</span>
                    vs last month
                </div>
            </div>

            <div class="stat-card equipment">
                <div class="stat-header">
                    <h3>Equipment Tested</h3>
                    <div class="stat-icon equipment">üîå</div>
                </div>
                <div class="stat-value">1,245</div>
                <div class="stat-change">
                    <span class="change-positive">‚Üë 87</span>
                    this month
                </div>
            </div>

            <div class="stat-card contractors">
                <div class="stat-header">
                    <h3>Active Contractors</h3>
                    <div class="stat-icon contractors">üë∑</div>
                </div>
                <div class="stat-value">3</div>
                <div class="stat-change">
                    All active
                </div>
            </div>

            <div class="stat-card alerts">
                <div class="stat-header">
                    <h3>Pending Actions</h3>
                    <div class="stat-icon alerts">‚ö†Ô∏è</div>
                </div>
                <div class="stat-value">12</div>
                <div class="stat-change">
                    <span class="change-negative">‚Üë 3</span>
                    require attention
                </div>
            </div>
        </div>

        <!-- Main Content Grid -->
        <div class="dashboard-grid">
            <!-- Sites Table -->
            <div class="dashboard-section">
                <div class="section-header">
                    <h2>üè¢ Managed Sites</h2>
                    <a href="#" class="view-all">View All Sites ‚Üí</a>
                </div>
                <table class="sites-table">
                    <thead>
                        <tr>
                            <th>Site Name</th>
                            <th>Location</th>
                            <th>Equipment</th>
                            <th>Compliance</th>
                            <th>Last Test</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Headquarters</strong></td>
                            <td>London, UK</td>
                            <td>320 items</td>
                            <td><span class="compliance-badge compliance-excellent">98%</span></td>
                            <td>Oct 24, 2024</td>
                            <td class="site-actions">
                                <button class="site-btn" onclick="viewSite('hq')">View</button>
                                <button class="site-btn" onclick="scheduleTest('hq')">Test</button>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Manchester Office</strong></td>
                            <td>Manchester, UK</td>
                            <td>185 items</td>
                            <td><span class="compliance-badge compliance-good">95%</span></td>
                            <td>Oct 22, 2024</td>
                            <td class="site-actions">
                                <button class="site-btn" onclick="viewSite('manchester')">View</button>
                                <button class="site-btn" onclick="scheduleTest('manchester')">Test</button>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Birmingham Warehouse</strong></td>
                            <td>Birmingham, UK</td>
                            <td>412 items</td>
                            <td><span class="compliance-badge compliance-warning">82%</span></td>
                            <td>Sep 15, 2024</td>
                            <td class="site-actions">
                                <button class="site-btn" onclick="viewSite('birmingham')">View</button>
                                <button class="site-btn" onclick="scheduleTest('birmingham')">Urgent</button>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Edinburgh Branch</strong></td>
                            <td>Edinburgh, UK</td>
                            <td>156 items</td>
                            <td><span class="compliance-badge compliance-poor">65%</span></td>
                            <td>Aug 30, 2024</td>
                            <td class="site-actions">
                                <button class="site-btn" onclick="viewSite('edinburgh')">View</button>
                                <button class="site-btn" onclick="scheduleTest('edinburgh')">Schedule</button>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Leeds Data Center</strong></td>
                            <td>Leeds, UK</td>
                            <td>172 items</td>
                            <td><span class="compliance-badge compliance-excellent">99%</span></td>
                            <td>Oct 26, 2024</td>
                            <td class="site-actions">
                                <button class="site-btn" onclick="viewSite('leeds')">View</button>
                                <button class="site-btn" onclick="downloadCerts('leeds')">Certs</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Alerts Panel -->
            <div class="dashboard-section">
                <div class="section-header">
                    <h2>‚ö†Ô∏è Alerts & Notifications</h2>
                    <a href="#" class="view-all">See All ‚Üí</a>
                </div>
                <div class="alerts-list">
                    <div class="alert-item critical">
                        <div class="alert-header">
                            <div class="alert-title">Critical: Compliance Deadline</div>
                            <div class="alert-time">2 hours ago</div>
                        </div>
                        <div class="alert-desc">Birmingham Warehouse testing overdue by 15 days. Action required.</div>
                        <div class="alert-actions">
                            <button class="alert-btn" onclick="resolveAlert('critical1')">Resolve</button>
                            <button class="alert-btn" onclick="assignContractor('critical1')">Assign</button>
                        </div>
                    </div>

                    <div class="alert-item warning">
                        <div class="alert-header">
                            <div class="alert-title">Contractor Schedule Change</div>
                            <div class="alert-time">1 day ago</div>
                        </div>
                        <div class="alert-desc">"SafeTest Ltd" rescheduled Glasgow site visit to Nov 5.</div>
                        <div class="alert-actions">
                            <button class="alert-btn" onclick="viewSchedule('alert2')">View</button>
                            <button class="alert-btn" onclick="approveChange('alert2')">Approve</button>
                        </div>
                    </div>

                    <div class="alert-item info">
                        <div class="alert-header">
                            <div class="alert-title">Monthly Report Ready</div>
                            <div class="alert-time">3 days ago</div>
                        </div>
                        <div class="alert-desc">October 2024 PAT compliance report is ready for download.</div>
                        <div class="alert-actions">
                            <button class="alert-btn" onclick="downloadReport('monthly')">Download</button>
                            <button class="alert-btn" onclick="shareReport('monthly')">Share</button>
                        </div>
                    </div>

                    <div class="alert-item warning">
                        <div class="alert-header">
                            <div class="alert-title">Equipment Added</div>
                            <div class="alert-time">5 days ago</div>
                        </div>
                        <div class="alert-desc">32 new appliances added to London HQ. Schedule testing required.</div>
                        <div class="alert-actions">
                            <button class="alert-btn" onclick="viewEquipment('new')">Review</button>
                            <button class="alert-btn" onclick="scheduleBulkTest('new')">Schedule</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Contractor Performance -->
        <div class="dashboard-section">
            <div class="section-header">
                <h2>üë∑ Contractor Performance</h2>
                <a href="#" class="view-all">Manage Contractors ‚Üí</a>
            </div>
            <div class="contractors-grid">
                <div class="contractor-card">
                    <div class="contractor-header">
                        <div class="contractor-name">SafeTest Ltd</div>
                        <div class="contractor-rating">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ 4.2</div>
                    </div>
                    <p class="contractor-desc">Primary contractor for Southern region</p>
                    <div class="contractor-stats">
                        <div class="contractor-stat">
                            <div class="stat-label">Active Sites</div>
                            <div class="stat-number">4</div>
                        </div>
                        <div class="contractor-stat">
                            <div class="stat-label">Completion Rate</div>
                            <div class="stat-number">98%</div>
                        </div>
                        <div class="contractor-stat">
                            <div class="stat-label">Avg. Response</div>
                            <div class="stat-number">4.2h</div>
                        </div>
                        <div class="contractor-stat">
                            <div class="stat-label">Certificates</div>
                            <div class="stat-number">312</div>
                        </div>
                    </div>
                    <div class="contractor-actions">
                        <button class="site-btn" type="button" onclick="viewContractor('safetest')">Details</button>
                        <button class="site-btn" type="button" onclick="messageContractor('safetest')">Message</button>
                    </div>
                </div>

                <div class="contractor-card">
                    <div class="contractor-header">
                        <div class="contractor-name">PowerCheck Solutions</div>
                        <div class="contractor-rating">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ 4.8</div>
                    </div>
                    <p class="contractor-desc">Specialist for industrial equipment</p>
                    <div class="contractor-stats">
                        <div class="contractor-stat">
                            <div class="stat-label">Active Sites</div>
                            <div class="stat-number">2</div>
                        </div>
                        <div class="contractor-stat">
                            <div class="stat-label">Completion Rate</div>
                            <div class="stat-number">100%</div>
                        </div>
                        <div class="contractor-stat">
                            <div class="stat-label">Avg. Response</div>
                            <div class="stat-number">2.1h</div>
                        </div>
                        <div class="contractor-stat">
                            <div class="stat-label">Certificates</div>
                            <div class="stat-number">172</div>
                        </div>
                    </div>
                    <div class="contractor-actions">
                        <button class="site-btn" type="button" onclick="viewContractor('powercheck')">Details</button>
                        <button class="site-btn" type="button" onclick="messageContractor('powercheck')">Message</button>
                    </div>
                </div>

                <div class="contractor-card">
                    <div class="contractor-header">
                        <div class="contractor-name">ElectroSafe UK</div>
                        <div class="contractor-rating">‚òÖ‚òÖ‚òÖ‚òÜ‚òÜ 3.6</div>
                    </div>
                    <p class="contractor-desc">Northern region coverage</p>
                    <div class="contractor-stats">
                        <div class="contractor-stat">
                            <div class="stat-label">Active Sites</div>
                            <div class="stat-number">2</div>
                        </div>
                        <div class="contractor-stat">
                            <div class="stat-label">Completion Rate</div>
                            <div class="stat-number">85%</div>
                        </div>
                        <div class="contractor-stat">
                            <div class="stat-label">Avg. Response</div>
                            <div class="stat-number">8.5h</div>
                        </div>
                        <div class="contractor-stat">
                            <div class="stat-label">Certificates</div>
                            <div class="stat-number">156</div>
                        </div>
                    </div>
                    <div class="contractor-actions">
                        <button class="site-btn" type="button" onclick="viewContractor('electrosafe')">Details</button>
                        <button class="site-btn" type="button" onclick="messageContractor('electrosafe')">Review</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Stats Footer -->
        <div class="dashboard-grid quick-stats-footer">
            <div class="dashboard-section dashboard-section-center">
                <h3 class="quick-stats-title">üìÖ Next Scheduled Tests</h3>
                <div class="quick-stats-main">
                    Nov 5: Glasgow Office (156 items)
                </div>
                <div class="quick-stats-sub">
                    Nov 8: Manchester Warehouse (212 items)
                </div>
            </div>
            
            <div class="dashboard-section dashboard-section-center">
                <h3 class="quick-stats-title">üìã Certificates Expiring Soon</h3>
                <div class="quick-stats-main quick-stats-main-alert">
                    42 certificates expire in November
                </div>
                <div class="quick-stats-sub">
                    Next expiry: Nov 15 (Birmingham Warehouse)
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <script>
        // Navigation
        function logout() {
            if (confirm('Are you sure you want to logout from the Business Portal?')) {
                window.location.href = 'index.html';
            }
        }

        // Toast notification helper
        function showToast(message, type = '') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = 'toast';
            if (type) toast.classList.add(type);
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Close modal helper
        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) modal.remove();
        }

        // Header Actions
        function generateReport() {
            const modalHTML = `
                <div class="modal-overlay" id="reportModal" onclick="if(event.target === this) closeModal('reportModal')">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title">üìä Generate Compliance Report</h2>
                            <button class="modal-close" onclick="closeModal('reportModal')">&times;</button>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 10px; color: #666;">Report Type</label>
                            <select id="reportType" style="width: 100%; padding: 12px; border: 2px solid #E3F2FD; border-radius: 8px; font-size: 1rem;">
                                <option value="monthly">Monthly Compliance Summary</option>
                                <option value="quarterly">Quarterly Compliance Report</option>
                                <option value="annual">Annual Compliance Report</option>
                                <option value="site-specific">Site-Specific Report</option>
                                <option value="contractor">Contractor Performance Report</option>
                                <option value="equipment">Equipment Testing Log</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 10px; color: #666;">Date Range</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <div>
                                    <label style="display: block; font-size: 0.85rem; color: #999; margin-bottom: 5px;">From</label>
                                    <input type="date" id="reportFrom" value="${new Date(Date.now() - 30*24*60*60*1000).toISOString().split('T')[0]}" style="width: 100%; padding: 10px; border: 2px solid #E3F2FD; border-radius: 8px;">
                                </div>
                                <div>
                                    <label style="display: block; font-size: 0.85rem; color: #999; margin-bottom: 5px;">To</label>
                                    <input type="date" id="reportTo" value="${new Date().toISOString().split('T')[0]}" style="width: 100%; padding: 10px; border: 2px solid #E3F2FD; border-radius: 8px;">
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 10px; color: #666;">Include Sections</label>
                            <div style="display: flex; flex-direction: column; gap: 10px;">
                                <label style="display: flex; align-items: center; gap: 10px;">
                                    <input type="checkbox" id="incl_summary" checked style="width: 18px; height: 18px;">
                                    <span>Executive Summary</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 10px;">
                                    <input type="checkbox" id="incl_compliance" checked style="width: 18px; height: 18px;">
                                    <span>Compliance Status by Site</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 10px;">
                                    <input type="checkbox" id="incl_charts" checked style="width: 18px; height: 18px;">
                                    <span>Charts & Visualizations</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 10px;">
                                    <input type="checkbox" id="incl_contractor" style="width: 18px; height: 18px;">
                                    <span>Contractor Performance Metrics</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 10px;">
                                    <input type="checkbox" id="incl_recommendations" style="width: 18px; height: 18px;">
                                    <span>AI-Generated Recommendations</span>
                                </label>
                            </div>
                        </div>
                        
                        <div style="background: #E3F2FD; padding: 15px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #2196F3;">
                            <div style="font-weight: 700; color: #1565C0; margin-bottom: 5px;">üìä Report Preview</div>
                            <div style="font-size: 0.9rem; color: #0D47A1;">
                                8 sites ‚Ä¢ 1,245 items tested ‚Ä¢ 98.2% compliance rate<br>
                                3 active contractors ‚Ä¢ 127 tests this period
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                            <button onclick="closeModal('reportModal')" style="padding: 14px; background: #f8f9fa; color: #666; border: 2px solid #E3F2FD; border-radius: 10px; font-weight: 600; cursor: pointer;">
                                Cancel
                            </button>
                            <button onclick="doGenerateReport()" style="padding: 14px; background: linear-gradient(135deg, #1976D2, #2196F3); color: white; border: none; border-radius: 10px; font-weight: 600; cursor: pointer;">
                                üìÑ Generate PDF
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }

        function doGenerateReport() {
            const reportType = document.getElementById('reportType').options[document.getElementById('reportType').selectedIndex].text;
            closeModal('reportModal');
            showToast('üîÑ Generating report...', 'info');
            
            setTimeout(() => {
                showToast(`‚úÖ ${reportType} generated successfully!`, 'success');
            }, 2000);
        }

        function addNewSite() {
            const modalHTML = `
                <div class="modal-overlay" id="newSiteModal" onclick="if(event.target === this) closeModal('newSiteModal')">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title">üè¢ Add New Site</h2>
                            <button class="modal-close" onclick="closeModal('newSiteModal')">&times;</button>
                        </div>
                        
                        <form id="newSiteForm" onsubmit="saveNewSite(event)" style="display: flex; flex-direction: column; gap: 15px;">
                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #666;">Site Name *</label>
                                <input type="text" id="siteName" required placeholder="e.g., Oxford Office HQ" style="width: 100%; padding: 12px; border: 2px solid #E3F2FD; border-radius: 8px; font-size: 1rem;">
                            </div>
                            
                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #666;">Address *</label>
                                <input type="text" id="siteAddress" required placeholder="Street address" style="width: 100%; padding: 12px; border: 2px solid #E3F2FD; border-radius: 8px; font-size: 1rem;">
                            </div>
                            
                            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 10px;">
                                <div>
                                    <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #666;">City *</label>
                                    <input type="text" id="siteCity" required placeholder="City" style="width: 100%; padding: 12px; border: 2px solid #E3F2FD; border-radius: 8px; font-size: 1rem;">
                                </div>
                                <div>
                                    <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #666;">Postcode *</label>
                                    <input type="text" id="sitePostcode" required placeholder="OX1 2AB" style="width: 100%; padding: 12px; border: 2px solid #E3F2FD; border-radius: 8px; font-size: 1rem;">
                                </div>
                            </div>
                            
                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #666;">Equipment Count *</label>
                                <input type="number" id="siteEquipment" required min="1" value="50" placeholder="Number of items" style="width: 100%; padding: 12px; border: 2px solid #E3F2FD; border-radius: 8px; font-size: 1rem;">
                            </div>
                            
                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #666;">Assign Contractor</label>
                                <select id="siteContractor" style="width: 100%; padding: 12px; border: 2px solid #E3F2FD; border-radius: 8px; font-size: 1rem;">
                                    <option value="">Select contractor...</option>
                                    <option value="electrosafe">ElectroSafe Testing</option>
                                    <option value="safetest">SafeTest Ltd</option>
                                    <option value="techpat">TechPAT Solutions</option>
                                </select>
                            </div>
                            
                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #666;">Testing Frequency</label>
                                <select id="siteFrequency" style="width: 100%; padding: 12px; border: 2px solid #E3F2FD; border-radius: 8px; font-size: 1rem;">
                                    <option value="3">Every 3 months</option>
                                    <option value="6" selected>Every 6 months</option>
                                    <option value="12">Annually</option>
                                    <option value="24">Every 2 years</option>
                                </select>
                            </div>
                            
                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #666;">Notes</label>
                                <textarea id="siteNotes" rows="3" placeholder="Access instructions, special requirements..." style="width: 100%; padding: 12px; border: 2px solid #E3F2FD; border-radius: 8px; font-size: 1rem; resize: vertical; font-family: inherit;"></textarea>
                            </div>
                            
                            <button type="submit" style="width: 100%; padding: 15px; margin-top: 10px; background: linear-gradient(135deg, #1976D2, #2196F3); color: white; border: none; border-radius: 12px; font-size: 1rem; font-weight: 700; cursor: pointer;">
                                ‚úÖ Add Site
                            </button>
                        </form>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }

        function saveNewSite(event) {
            event.preventDefault();
            
            const siteName = document.getElementById('siteName').value;
            const equipment = document.getElementById('siteEquipment').value;
            
            closeModal('newSiteModal');
            showToast(`‚úÖ ${siteName} added successfully with ${equipment} items`, 'success');
            
            console.log('New site created:', {
                name: siteName,
                address: document.getElementById('siteAddress').value,
                city: document.getElementById('siteCity').value,
                postcode: document.getElementById('sitePostcode').value,
                equipment: equipment,
                contractor: document.getElementById('siteContractor').value,
                frequency: document.getElementById('siteFrequency').value,
                notes: document.getElementById('siteNotes').value
            });
        }

        // Site Actions
        function viewSite(siteId) {
            const modalHTML = `
                <div class="modal-overlay" id="viewSiteModal" onclick="if(event.target === this) closeModal('viewSiteModal')">
                    <div class="modal-content" style="max-width: 650px;">
                        <div class="modal-header">
                            <h2 class="modal-title">üè¢ Site Details</h2>
                            <button class="modal-close" onclick="closeModal('viewSiteModal')">&times;</button>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #1976D2, #2196F3); color: white; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                            <div style="font-size: 1.4rem; font-weight: 700; margin-bottom: 8px;">${siteId}</div>
                            <div style="opacity: 0.9;">123 Main Street, Oxford, OX1 2AB</div>
                            <div style="display: flex; gap: 15px; margin-top: 15px; font-size: 0.9rem;">
                                <div style="background: rgba(255,255,255,0.2); padding: 8px 16px; border-radius: 20px;">
                                    ‚úÖ Compliant
                                </div>
                                <div style="background: rgba(255,255,255,0.2); padding: 8px 16px; border-radius: 20px;">
                                    Next test: Feb 15
                                </div>
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 20px;">
                            <div style="background: #E3F2FD; padding: 15px; border-radius: 10px; text-align: center;">
                                <div style="font-size: 2rem; font-weight: 800; color: #1976D2;">156</div>
                                <div style="font-size: 0.85rem; color: #666;">Total Items</div>
                            </div>
                            <div style="background: #E8F5E9; padding: 15px; border-radius: 10px; text-align: center;">
                                <div style="font-size: 2rem; font-weight: 800; color: #4CAF50;">154</div>
                                <div style="font-size: 0.85rem; color: #666;">Passed</div>
                            </div>
                            <div style="background: #FFEBEE; padding: 15px; border-radius: 10px; text-align: center;">
                                <div style="font-size: 2rem; font-weight: 800; color: #F44336;">2</div>
                                <div style="font-size: 0.85rem; color: #666;">Failed</div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <h3 style="font-size: 1.1rem; color: #333; margin-bottom: 12px;">Test History</h3>
                            <div style="display: flex; flex-direction: column; gap: 10px;">
                                <div style="background: #f8f9fa; padding: 12px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <div style="font-weight: 600;">Last Test: Jan 15, 2025</div>
                                        <div style="font-size: 0.9rem; color: #666;">ElectroSafe Testing - 156 items</div>
                                    </div>
                                    <div style="color: #4CAF50; font-weight: 700;">‚úì Pass</div>
                                </div>
                                <div style="background: #f8f9fa; padding: 12px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <div style="font-weight: 600;">Previous: Jul 20, 2024</div>
                                        <div style="font-size: 0.9rem; color: #666;">ElectroSafe Testing - 152 items</div>
                                    </div>
                                    <div style="color: #4CAF50; font-weight: 700;">‚úì Pass</div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <h3 style="font-size: 1.1rem; color: #333; margin-bottom: 12px;">Assigned Contractor</h3>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 10px;">
                                <div style="font-weight: 700; margin-bottom: 5px;">ElectroSafe Testing</div>
                                <div style="font-size: 0.9rem; color: #666;">Rating: ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ 4.8 ‚Ä¢ 200 tests completed</div>
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                            <button onclick="scheduleTest('${siteId}')" class="action-btn primary" style="padding: 12px; background: linear-gradient(135deg, #1976D2, #2196F3); color: white; border: none; border-radius: 10px; font-weight: 600; cursor: pointer;">
                                üìÖ Schedule Test
                            </button>
                            <button onclick="downloadCerts('${siteId}')" class="action-btn" style="padding: 12px; background: #E3F2FD; color: #1976D2; border: none; border-radius: 10px; font-weight: 600; cursor: pointer;">
                                üìÑ Certificates
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }

        function scheduleTest(siteId) {
            closeModal('viewSiteModal');
            
            const modalHTML = `
                <div class="modal-overlay" id="scheduleModal" onclick="if(event.target === this) closeModal('scheduleModal')">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title">üìÖ Schedule PAT Test</h2>
                            <button class="modal-close" onclick="closeModal('scheduleModal')">&times;</button>
                        </div>
                        
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                            <div style="font-weight: 700; color: #333; margin-bottom: 5px;">Site: ${siteId}</div>
                            <div style="font-size: 0.9rem; color: #666;">156 items to test</div>
                        </div>
                        
                        <form id="scheduleForm" onsubmit="confirmSchedule(event, '${siteId}')" style="display: flex; flex-direction: column; gap: 15px;">
                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #666;">Select Contractor *</label>
                                <select id="scheduleContractor" required style="width: 100%; padding: 12px; border: 2px solid #E3F2FD; border-radius: 8px; font-size: 1rem;">
                                    <option value="electrosafe" selected>ElectroSafe Testing (‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ 4.8)</option>
                                    <option value="safetest">SafeTest Ltd (‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ 4.2)</option>
                                    <option value="techpat">TechPAT Solutions (‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ 4.5)</option>
                                </select>
                            </div>
                            
                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #666;">Preferred Date *</label>
                                <input type="date" id="scheduleDate" required value="${new Date(Date.now() + 7*24*60*60*1000).toISOString().split('T')[0]}" min="${new Date().toISOString().split('T')[0]}" style="width: 100%; padding: 12px; border: 2px solid #E3F2FD; border-radius: 8px; font-size: 1rem;">
                            </div>
                            
                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #666;">Estimated Duration</label>
                                <select id="scheduleDuration" style="width: 100%; padding: 12px; border: 2px solid #E3F2FD; border-radius: 8px; font-size: 1rem;">
                                    <option value="2">Half day (2-3 hours)</option>
                                    <option value="4" selected>Full day (4-6 hours)</option>
                                    <option value="8">Multiple days</option>
                                </select>
                            </div>
                            
                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #666;">Special Instructions</label>
                                <textarea id="scheduleNotes" rows="3" placeholder="Access codes, parking info, equipment locations..." style="width: 100%; padding: 12px; border: 2px solid #E3F2FD; border-radius: 8px; font-size: 1rem; resize: vertical; font-family: inherit;"></textarea>
                            </div>
                            
                            <div style="background: #FFF3CD; padding: 12px; border-radius: 8px; font-size: 0.9rem; color: #856404; border-left: 4px solid #FFC107;">
                                üí° Contractor will be notified and will confirm availability within 24 hours
                            </div>
                            
                            <button type="submit" style="width: 100%; padding: 15px; margin-top: 10px; background: linear-gradient(135deg, #1976D2, #2196F3); color: white; border: none; border-radius: 12px; font-size: 1rem; font-weight: 700; cursor: pointer;">
                                ‚úÖ Send Request
                            </button>
                        </form>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }

        function confirmSchedule(event, siteId) {
            event.preventDefault();
            
            const date = document.getElementById('scheduleDate').value;
            const contractor = document.getElementById('scheduleContractor').options[document.getElementById('scheduleContractor').selectedIndex].text;
            
            closeModal('scheduleModal');
            showToast(`‚úÖ Test scheduled for ${siteId} on ${new Date(date).toLocaleDateString('en-GB')}`, 'success');
            
            console.log('Test scheduled:', { siteId, date, contractor });
        }

        function downloadCerts(siteId) {
            closeModal('viewSiteModal');
            // Redirect to certificate generator to show how certificates work
            if (confirm(`View sample PAT certificate for ${siteId}?\n\nThis will show you the certificate generation interface.`)) {
                window.location.href = 'generate-certificate.html';
            }
        }

        // Alert Actions
        function resolveAlert(alertId) {
            if (confirm('Mark this alert as resolved?')) {
                showToast('‚úÖ Alert resolved successfully', 'success');
                // In production, would update database and refresh UI
            }
        }

        function assignContractor(alertId) {
            const modalHTML = `
                <div class="modal-overlay" id="assignModal" onclick="if(event.target === this) closeModal('assignModal')">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title">üë∑ Assign Contractor</h2>
                            <button class="modal-close" onclick="closeModal('assignModal')">&times;</button>
                        </div>
                        
                        <div style="background: #FFEBEE; padding: 15px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #F44336;">
                            <div style="font-weight: 700; color: #C62828; margin-bottom: 5px;">‚ö†Ô∏è Critical Alert</div>
                            <div style="font-size: 0.9rem; color: #C62828;">Birmingham Warehouse testing overdue by 15 days</div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 10px; color: #666;">Select Contractor</label>
                            <div style="display: flex; flex-direction: column; gap: 10px;">
                                <label style="display: flex; align-items: center; gap: 12px; padding: 15px; background: #f8f9fa; border: 2px solid #E3F2FD; border-radius: 10px; cursor: pointer; transition: all 0.2s;">
                                    <input type="radio" name="contractor" value="electrosafe" checked style="width: 20px; height: 20px;">
                                    <div style="flex: 1;">
                                        <div style="font-weight: 700;">ElectroSafe Testing</div>
                                        <div style="font-size: 0.85rem; color: #666;">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ 4.8 ‚Ä¢ Available tomorrow</div>
                                    </div>
                                    <div style="color: #4CAF50; font-weight: 600;">Available</div>
                                </label>
                                <label style="display: flex; align-items: center; gap: 12px; padding: 15px; background: #f8f9fa; border: 2px solid #E3F2FD; border-radius: 10px; cursor: pointer;">
                                    <input type="radio" name="contractor" value="safetest" style="width: 20px; height: 20px;">
                                    <div style="flex: 1;">
                                        <div style="font-weight: 700;">SafeTest Ltd</div>
                                        <div style="font-size: 0.85rem; color: #666;">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ 4.2 ‚Ä¢ Available in 3 days</div>
                                    </div>
                                    <div style="color: #FF9800; font-weight: 600;">Busy</div>
                                </label>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #666;">Priority Level</label>
                            <select style="width: 100%; padding: 12px; border: 2px solid #E3F2FD; border-radius: 8px; font-size: 1rem;">
                                <option value="urgent" selected>üî¥ Urgent - Within 24 hours</option>
                                <option value="high">üü† High - Within 3 days</option>
                                <option value="normal">üü¢ Normal - Within week</option>
                            </select>
                        </div>
                        
                        <button onclick="doAssignContractor()" style="width: 100%; padding: 15px; background: linear-gradient(135deg, #F44336, #EF5350); color: white; border: none; border-radius: 12px; font-size: 1rem; font-weight: 700; cursor: pointer;">
                            ‚ö° Assign Urgently
                        </button>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }

        function doAssignContractor() {
            closeModal('assignModal');
            showToast('‚úÖ Contractor assigned and notified', 'success');
        }

        function viewSchedule(alertId) {
            showToast('üìÖ Opening schedule view...', 'info');
            setTimeout(() => {
                window.location.href = 'weekly-schedule.html';
            }, 1000);
        }

        function approveChange(alertId) {
            if (confirm('Approve this schedule change?')) {
                showToast('‚úÖ Schedule change approved', 'success');
            }
        }

        function downloadReport(reportId) {
            showToast('üì• Preparing download...', 'info');
            setTimeout(() => {
                showToast('‚úÖ Report downloaded successfully!', 'success');
            }, 1500);
        }

        function shareReport(reportId) {
            const modalHTML = `
                <div class="modal-overlay" id="shareModal" onclick="if(event.target === this) closeModal('shareModal')">
                    <div class="modal-content" style="max-width: 450px;">
                        <div class="modal-header">
                            <h2 class="modal-title">üì§ Share Report</h2>
                            <button class="modal-close" onclick="closeModal('shareModal')">&times;</button>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #666;">Email Recipients</label>
                            <input type="email" placeholder="email@company.com" style="width: 100%; padding: 12px; border: 2px solid #E3F2FD; border-radius: 8px; font-size: 1rem; margin-bottom: 8px;">
                            <div style="font-size: 0.85rem; color: #666;">Separate multiple emails with commas</div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 10px; color: #666;">Or Share via Link</label>
                            <div style="display: flex; gap: 10px;">
                                <input type="text" value="https://patbudai4u.com/reports/${reportId}" readonly style="flex: 1; padding: 12px; border: 2px solid #E3F2FD; border-radius: 8px; background: #f8f9fa;">
                                <button onclick="copyShareLink()" style="padding: 12px 20px; background: #E3F2FD; color: #1976D2; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
                                    üìã Copy
                                </button>
                            </div>
                        </div>
                        
                        <button onclick="doShareReport()" style="width: 100%; padding: 15px; background: linear-gradient(135deg, #1976D2, #2196F3); color: white; border: none; border-radius: 12px; font-size: 1rem; font-weight: 700; cursor: pointer;">
                            üìß Send Email
                        </button>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }

        function copyShareLink() {
            showToast('üìã Link copied to clipboard!', 'success');
        }

        function doShareReport() {
            closeModal('shareModal');
            showToast('‚úÖ Report shared successfully!', 'success');
        }

        function viewEquipment(equipmentId) {
            showToast('üîå Loading equipment details...', 'info');
        }

        function scheduleBulkTest(equipmentId) {
            showToast('üìÖ Opening bulk scheduling...', 'info');
        }

        // Contractor Actions
        function viewContractor(contractorId) {
            const modalHTML = `
                <div class="modal-overlay" id="contractorModal" onclick="if(event.target === this) closeModal('contractorModal')">
                    <div class="modal-content" style="max-width: 600px;">
                        <div class="modal-header">
                            <h2 class="modal-title">üë∑ Contractor Profile</h2>
                            <button class="modal-close" onclick="closeModal('contractorModal')">&times;</button>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #1976D2, #2196F3); color: white; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px;">
                                <div>
                                    <div style="font-size: 1.4rem; font-weight: 700; margin-bottom: 5px;">ElectroSafe Testing</div>
                                    <div style="opacity: 0.9;">Certified PAT Testing Specialist</div>
                                </div>
                                <div style="background: rgba(255,255,255,0.2); padding: 8px 16px; border-radius: 20px; font-weight: 600;">
                                    ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ 4.8
                                </div>
                            </div>
                            <div style="display: flex; gap: 15px; font-size: 0.9rem;">
                                <div>üìç Oxford & Surrounding</div>
                                <div>üìû +44 7700 900123</div>
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 20px;">
                            <div style="text-align: center; padding: 15px; background: #E3F2FD; border-radius: 10px;">
                                <div style="font-size: 1.8rem; font-weight: 800; color: #1976D2;">5</div>
                                <div style="font-size: 0.85rem; color: #666;">Active Sites</div>
                            </div>
                            <div style="text-align: center; padding: 15px; background: #E8F5E9; border-radius: 10px;">
                                <div style="font-size: 1.8rem; font-weight: 800; color: #4CAF50;">98%</div>
                                <div style="font-size: 0.85rem; color: #666;">Pass Rate</div>
                            </div>
                            <div style="text-align: center; padding: 15px; background: #FFF3E0; border-radius: 10px;">
                                <div style="font-size: 1.8rem; font-weight: 800; color: #FF9800;">200</div>
                                <div style="font-size: 0.85rem; color: #666;">Tests Done</div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <h3 style="font-size: 1.1rem; color: #333; margin-bottom: 12px;">Recent Activity</h3>
                            <div style="display: flex; flex-direction: column; gap: 10px;">
                                <div style="background: #f8f9fa; padding: 12px; border-radius: 8px;">
                                    <div style="font-weight: 600;">Oxford Office HQ - Jan 15, 2025</div>
                                    <div style="font-size: 0.9rem; color: #666;">156 items tested ‚Ä¢ 100% pass rate</div>
                                </div>
                                <div style="background: #f8f9fa; padding: 12px; border-radius: 8px;">
                                    <div style="font-weight: 600;">London Branch - Jan 10, 2025</div>
                                    <div style="font-size: 0.9rem; color: #666;">89 items tested ‚Ä¢ 98% pass rate</div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                            <button onclick="messageContractor('${contractorId}')" style="padding: 12px; background: #E3F2FD; color: #1976D2; border: none; border-radius: 10px; font-weight: 600; cursor: pointer;">
                                ‚úâÔ∏è Message
                            </button>
                            <button onclick="viewSchedule('${contractorId}')" style="padding: 12px; background: linear-gradient(135deg, #1976D2, #2196F3); color: white; border: none; border-radius: 10px; font-weight: 600; cursor: pointer;">
                                üìÖ Schedule
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }

        function messageContractor(contractorId) {
            closeModal('contractorModal');
            
            const modalHTML = `
                <div class="modal-overlay" id="messageModal" onclick="if(event.target === this) closeModal('messageModal')">
                    <div class="modal-content" style="max-width: 500px;">
                        <div class="modal-header">
                            <h2 class="modal-title">‚úâÔ∏è Message Contractor</h2>
                            <button class="modal-close" onclick="closeModal('messageModal')">&times;</button>
                        </div>
                        
                        <div style="background: #E3F2FD; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                            <div style="font-weight: 700; color: #1565C0;">To: ElectroSafe Testing</div>
                            <div style="font-size: 0.9rem; color: #0D47A1;">Secure encrypted messaging</div>
                        </div>
                        
                        <form onsubmit="sendMessage(event)" style="display: flex; flex-direction: column; gap: 15px;">
                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #666;">Subject</label>
                                <input type="text" placeholder="e.g., Urgent testing required" required style="width: 100%; padding: 12px; border: 2px solid #E3F2FD; border-radius: 8px; font-size: 1rem;">
                            </div>
                            
                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #666;">Message</label>
                                <textarea rows="6" required placeholder="Type your message here..." style="width: 100%; padding: 12px; border: 2px solid #E3F2FD; border-radius: 8px; font-size: 1rem; resize: vertical; font-family: inherit;"></textarea>
                            </div>
                            
                            <div style="background: #FFF3CD; padding: 12px; border-radius: 8px; font-size: 0.85rem; color: #856404; border-left: 4px solid #FFC107;">
                                üîí Messages are encrypted end-to-end for security
                            </div>
                            
                            <button type="submit" style="width: 100%; padding: 15px; background: linear-gradient(135deg, #1976D2, #2196F3); color: white; border: none; border-radius: 12px; font-size: 1rem; font-weight: 700; cursor: pointer;">
                                üì§ Send Message
                            </button>
                        </form>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }

        function sendMessage(event) {
            event.preventDefault();
            closeModal('messageModal');
            showToast('‚úÖ Message sent to contractor', 'success');
        }

        // Keyboard shortcuts for power users
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + R for report
            if ((e.ctrlKey || e.metaKey) && e.key === 'r') {
                e.preventDefault();
                generateReport();
            }
            
            // Ctrl/Cmd + N for new site
            if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
                e.preventDefault();
                addNewSite();
            }
            
            // Escape to focus search (if implemented)
            if (e.key === 'Escape') {
                console.log('Focus search field');
                // In production, this would focus on search input
            }
        });

        // Demo initialization
        window.onload = function() {
            console.log('Business Dashboard loaded - Demo Mode');
            console.log('Company: TechCorp Global Ltd');
            console.log('Sites: 8 | Equipment: 1,245 | Contractors: 3');
            
            // Simulate real-time updates
            setInterval(() => {
                // In production, this would fetch live data
                console.log('Demo: Simulating real-time data updates...');
            }, 30000);
        }

        // Example of data visualization that could be added
        function showComplianceTrend() {
            const modalHTML = `
                <div class="modal-overlay" id="trendModal" onclick="if(event.target === this) closeModal('trendModal')">
                    <div class="modal-content" style="max-width: 700px;">
                        <div class="modal-header">
                            <h2 class="modal-title">üìà Compliance Trend</h2>
                            <button class="modal-close" onclick="closeModal('trendModal')">&times;</button>
                        </div>
                        
                        <div style="background: #E3F2FD; padding: 20px; border-radius: 12px; margin-bottom: 20px; text-align: center;">
                            <div style="font-size: 3rem; margin-bottom: 10px;">üìä</div>
                            <div style="font-size: 1.3rem; font-weight: 700; color: #1565C0; margin-bottom: 5px;">98.2% Compliance Rate</div>
                            <div style="color: #0D47A1;">Across all sites - Last 6 months</div>
                        </div>
                        
                        <div style="display: flex; flex-direction: column; gap: 12px; margin-bottom: 20px;">
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 10px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="font-weight: 600;">Jan 2025</span>
                                    <span style="color: #4CAF50; font-weight: 700;">98.5%</span>
                                </div>
                                <div style="background: #E8F5E9; height: 8px; border-radius: 4px; overflow: hidden;">
                                    <div style="background: #4CAF50; width: 98.5%; height: 100%;"></div>
                                </div>
                            </div>
                            
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 10px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="font-weight: 600;">Dec 2024</span>
                                    <span style="color: #4CAF50; font-weight: 700;">97.8%</span>
                                </div>
                                <div style="background: #E8F5E9; height: 8px; border-radius: 4px; overflow: hidden;">
                                    <div style="background: #4CAF50; width: 97.8%; height: 100%;"></div>
                                </div>
                            </div>
                            
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 10px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="font-weight: 600;">Nov 2024</span>
                                    <span style="color: #4CAF50; font-weight: 700;">99.1%</span>
                                </div>
                                <div style="background: #E8F5E9; height: 8px; border-radius: 4px; overflow: hidden;">
                                    <div style="background: #4CAF50; width: 99.1%; height: 100%;"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="background: #E8F5E9; padding: 15px; border-radius: 10px; border-left: 4px solid #4CAF50;">
                            <div style="font-weight: 700; color: #2E7D32; margin-bottom: 5px;">üìä Trend Analysis</div>
                            <div style="font-size: 0.9rem; color: #2E7D32;">
                                Consistent compliance above 97% ‚Ä¢ On track for annual targets ‚Ä¢ Zero critical failures
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }

        // Export functionality
        function exportAllData() {
            const modalHTML = `
                <div class="modal-overlay" id="exportDataModal" onclick="if(event.target === this) closeModal('exportDataModal')">
                    <div class="modal-content" style="max-width: 500px;">
                        <div class="modal-header">
                            <h2 class="modal-title">üì§ Export All Data</h2>
                            <button class="modal-close" onclick="closeModal('exportDataModal')">&times;</button>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 12px; color: #666;">Select Data to Export</label>
                            <div style="display: flex; flex-direction: column; gap: 10px;">
                                <label style="display: flex; align-items: center; gap: 10px; padding: 12px; background: #f8f9fa; border-radius: 8px; cursor: pointer;">
                                    <input type="checkbox" checked style="width: 18px; height: 18px;">
                                    <span>All Sites & Equipment</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 10px; padding: 12px; background: #f8f9fa; border-radius: 8px; cursor: pointer;">
                                    <input type="checkbox" checked style="width: 18px; height: 18px;">
                                    <span>Test Results & Certificates</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 10px; padding: 12px; background: #f8f9fa; border-radius: 8px; cursor: pointer;">
                                    <input type="checkbox" checked style="width: 18px; height: 18px;">
                                    <span>Contractor Information</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 10px; padding: 12px; background: #f8f9fa; border-radius: 8px; cursor: pointer;">
                                    <input type="checkbox" style="width: 18px; height: 18px;">
                                    <span>Compliance Reports</span>
                                </label>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 10px; color: #666;">Export Format</label>
                            <select id="exportFormat" style="width: 100%; padding: 12px; border: 2px solid #E3F2FD; border-radius: 8px; font-size: 1rem;">
                                <option value="xlsx">Excel (.xlsx)</option>
                                <option value="csv">CSV (.csv)</option>
                                <option value="json">JSON (.json)</option>
                                <option value="pdf">PDF Report</option>
                            </select>
                        </div>
                        
                        <div style="background: #E3F2FD; padding: 15px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #2196F3;">
                            <div style="font-weight: 700; color: #1565C0; margin-bottom: 5px;">üìä Export Summary</div>
                            <div style="font-size: 0.9rem; color: #0D47A1;">
                                8 sites ‚Ä¢ 1,245 items ‚Ä¢ 127 certificates ‚Ä¢ 3 contractors
                            </div>
                        </div>
                        
                        <button onclick="doExportData()" style="width: 100%; padding: 15px; background: linear-gradient(135deg, #1976D2, #2196F3); color: white; border: none; border-radius: 12px; font-size: 1rem; font-weight: 700; cursor: pointer;">
                            üì• Export Data
                        </button>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }

        function doExportData() {
            const format = document.getElementById('exportFormat').value.toUpperCase();
            closeModal('exportDataModal');
            showToast(`üîÑ Preparing ${format} export...`, 'info');
            
            setTimeout(() => {
                showToast(`‚úÖ Data exported successfully as ${format}!`, 'success');
            }, 2000);
        }
    </script>
</body>
</html>